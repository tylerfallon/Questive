{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"../utils/is_remote.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"isRemote"}]},{"source":"../utils/call_meteor_method.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"callMeteorMethod"}]},{"source":"../utils/class_update.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"classUpdate"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/jagi:astronomy/lib/modules/storage/class_static_methods/update.js","filenameRelative":"/packages/jagi:astronomy/lib/modules/storage/class_static_methods/update.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/jagi:astronomy/lib/modules/storage/class_static_methods/update.js.map","sourceFileName":"/packages/jagi:astronomy/lib/modules/storage/class_static_methods/update.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"update"},"ignored":false,"code":"var isRemote;module.import('../utils/is_remote.js',{\"default\":function(v){isRemote=v}});var callMeteorMethod;module.import('../utils/call_meteor_method.js',{\"default\":function(v){callMeteorMethod=v}});var classUpdate;module.import('../utils/class_update.js',{\"default\":function(v){classUpdate=v}});\n\n\n\nfunction update(selector, modifier, options, callback) {\n  var Class = this;\n\n  // If we omit options argument then it may be a callback function.\n  if (options instanceof Function) {\n    callback = options;\n    options = {};\n  }\n  // Make sure that options is at least an empty object.\n  options = options || {};\n  // Prepare arguments.\n  var args = {\n    className: Class.getName(),\n    selector: selector,\n    modifier: modifier,\n    options: options\n  };\n\n  // If we are dealing with a remote collection and we are not on the server.\n  if (isRemote(Class)) {\n    // Prepare meteor method name to be called.\n    var methodName = '/Astronomy/update';\n\n    try {\n      // Run Meteor method.\n      return callMeteorMethod(Class, methodName, [args], callback);\n    }\n    // Catch stub exceptions.\n    catch (err) {\n      if (callback) {\n        callback(err);\n        return null;\n      }\n      throw err;\n    }\n  }\n\n  // If we can just remove a document without calling the meteor method. We may\n  // be on the server or the collection may be local.\n  try {\n    // Set the \"trusted\" argument to true.\n    args.trusted = true;\n    // Remove a document.\n    var result = classUpdate(args);\n    if (callback) {\n      callback(undefined, result);\n    }\n    return result;\n  } catch (err) {\n    if (callback) {\n      callback(err);\n      return null;\n    }\n    throw err;\n  }\n}\n\nmodule.export(\"default\",exports.default=(update));","ast":null,"map":{"version":3,"sources":["/packages/jagi:astronomy/lib/modules/storage/class_static_methods/update.js"],"names":[],"mappings":"AAAA,OAAO,QAAP,MAAqB,uBAArB;AACA,OAAO,gBAAP,MAA6B,gCAA7B;AACA,OAAO,WAAP,MAAwB,0BAAxB;;AAEA,SAAS,MAAT,CAAgB,QAAhB,EAA0B,QAA1B,EAAoC,OAApC,EAA6C,QAA7C,EAAuD;AACrD,MAAM,QAAQ,IAAd;;;AAGA,MAAI,mBAAmB,QAAvB,EAAiC;AAC/B,eAAW,OAAX;AACA,cAAU,EAAV;AACD;;AAED,YAAU,WAAW,EAArB;;AAEA,MAAM,OAAO;AACX,eAAW,MAAM,OAAN,EADA;AAEX,sBAFW;AAGX,sBAHW;AAIX;AAJW,GAAb;;;AAQA,MAAI,SAAS,KAAT,CAAJ,EAAqB;;AAEnB,QAAM,aAAa,mBAAnB;;AAEA,QAAI;;AAEF,aAAO,iBACL,KADK,EACE,UADF,EACc,CAAC,IAAD,CADd,EACsB,QADtB,CAAP;AAGD;;AAED,WAAO,GAAP,EAAY;AACV,UAAI,QAAJ,EAAc;AACZ,iBAAS,GAAT;AACA,eAAO,IAAP;AACD;AACD,YAAM,GAAN;AACD;AACF;;;;AAID,MAAI;;AAEF,SAAK,OAAL,GAAe,IAAf;;AAEA,QAAI,SAAS,YAAY,IAAZ,CAAb;AACA,QAAI,QAAJ,EAAc;AACZ,eAAS,SAAT,EAAoB,MAApB;AACD;AACD,WAAO,MAAP;AACD,GATD,CAUA,OAAO,GAAP,EAAY;AACV,QAAI,QAAJ,EAAc;AACZ,eAAS,GAAT;AACA,aAAO,IAAP;AACD;AACD,UAAM,GAAN;AACD;AACF;;AAED,eAAe,MAAf","file":"/packages/jagi:astronomy/lib/modules/storage/class_static_methods/update.js.map","sourcesContent":["import isRemote from '../utils/is_remote.js';\nimport callMeteorMethod from '../utils/call_meteor_method.js';\nimport classUpdate from '../utils/class_update.js';\n\nfunction update(selector, modifier, options, callback) {\n  const Class = this;\n\n  // If we omit options argument then it may be a callback function.\n  if (options instanceof Function) {\n    callback = options;\n    options = {};\n  }\n  // Make sure that options is at least an empty object.\n  options = options || {};\n  // Prepare arguments.\n  const args = {\n    className: Class.getName(),\n    selector,\n    modifier,\n    options\n  };\n\n  // If we are dealing with a remote collection and we are not on the server.\n  if (isRemote(Class)) {\n    // Prepare meteor method name to be called.\n    const methodName = '/Astronomy/update';\n\n    try {\n      // Run Meteor method.\n      return callMeteorMethod(\n        Class, methodName, [args], callback\n      );\n    }\n    // Catch stub exceptions.\n    catch (err) {\n      if (callback) {\n        callback(err);\n        return null;\n      }\n      throw err;\n    }\n  }\n\n  // If we can just remove a document without calling the meteor method. We may\n  // be on the server or the collection may be local.\n  try {\n    // Set the \"trusted\" argument to true.\n    args.trusted = true;\n    // Remove a document.\n    let result = classUpdate(args);\n    if (callback) {\n      callback(undefined, result);\n    }\n    return result;\n  }\n  catch (err) {\n    if (callback) {\n      callback(err);\n      return null;\n    }\n    throw err;\n  }\n}\n\nexport default update;"]},"hash":"a8809efd76b9dbffe33ace663b7a7622d8526157"}
