{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"lodash","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"_"}]},{"source":"../../../core/class.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"AstroClass"}]},{"source":"./traverse.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"traverse"}]},{"source":"./raw_all.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"rawAll"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/jagi:astronomy/lib/modules/fields/utils/raw_one.js","filenameRelative":"/packages/jagi:astronomy/lib/modules/fields/utils/raw_one.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/jagi:astronomy/lib/modules/fields/utils/raw_one.js.map","sourceFileName":"/packages/jagi:astronomy/lib/modules/fields/utils/raw_one.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"raw_one"},"ignored":false,"code":"var _;module.import('lodash',{\"default\":function(v){_=v}});var AstroClass;module.import('../../../core/class.js',{\"default\":function(v){AstroClass=v}});var traverse;module.import('./traverse.js',{\"default\":function(v){traverse=v}});var rawAll;module.import('./raw_all.js',{\"default\":function(v){rawAll=v}});\n\n\n\n\nfunction rawOne(doc, fieldPattern, options) {\n\t// Prepare options.\n\toptions = _.extend({\n\t\ttransient: true,\n\t\timmutable: true\n\t}, options);\n\n\treturn traverse(doc, fieldPattern, function (nestedDoc, nestedFieldName, field) {\n\t\t// If a field does not exist than we don't return anything.\n\t\tif (!field) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Don't get a transient field.\n\t\tif (!options.transient && field.transient) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Don't get an immutable field.\n\t\tif (!options.immutable && field.immutable) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get a value to be returned.\n\t\tvar fieldValue = nestedDoc[nestedFieldName];\n\n\t\tif (fieldValue instanceof AstroClass) {\n\t\t\treturn rawAll(fieldValue, options);\n\t\t} else if (_.isArray(fieldValue)) {\n\t\t\treturn _.map(fieldValue, function (element) {\n\t\t\t\tif (element instanceof AstroClass) {\n\t\t\t\t\treturn rawAll(element, options);\n\t\t\t\t} else {\n\t\t\t\t\treturn element;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn fieldValue;\n\t\t}\n\t});\n};\n\nmodule.export(\"default\",exports.default=(rawOne));","ast":null,"map":{"version":3,"sources":["/packages/jagi:astronomy/lib/modules/fields/utils/raw_one.js"],"names":[],"mappings":"AAAA,OAAO,CAAP,MAAc,QAAd;AACA,OAAO,UAAP,MAAuB,wBAAvB;AACA,OAAO,QAAP,MAAqB,eAArB;AACA,OAAO,MAAP,MAAmB,cAAnB;;AAEA,SAAS,MAAT,CAAgB,GAAhB,EAAqB,YAArB,EAAmC,OAAnC,EAA4C;;AAE3C,WAAU,EAAE,MAAF,CAAS;AAClB,aAAW,IADO;AAElB,aAAW;AAFO,EAAT,EAGP,OAHO,CAAV;;AAKA,QAAO,SACN,GADM,EACD,YADC,EAEN,UAAS,SAAT,EAAoB,eAApB,EAAqC,KAArC,EAA4C;;AAE3C,MAAI,CAAC,KAAL,EAAY;AACX;AACA;;;AAGD,MAAI,CAAC,QAAQ,SAAT,IAAsB,MAAM,SAAhC,EAA2C;AAC1C;AACA;;;AAGD,MAAI,CAAC,QAAQ,SAAT,IAAsB,MAAM,SAAhC,EAA2C;AAC1C;AACA;;;AAGD,MAAI,aAAa,UAAU,eAAV,CAAjB;;AAEA,MAAI,sBAAsB,UAA1B,EAAsC;AACrC,UAAO,OAAO,UAAP,EAAmB,OAAnB,CAAP;AACA,GAFD,MAGK,IAAI,EAAE,OAAF,CAAU,UAAV,CAAJ,EAA2B;AAC/B,UAAO,EAAE,GAAF,CAAM,UAAN,EAAkB,UAAS,OAAT,EAAkB;AAC1C,QAAI,mBAAmB,UAAvB,EAAmC;AAClC,YAAO,OAAO,OAAP,EAAgB,OAAhB,CAAP;AACA,KAFD,MAGK;AACJ,YAAO,OAAP;AACA;AACD,IAPM,CAAP;AAQA,GATI,MAUA;AACJ,UAAO,UAAP;AACA;AACD,EArCK,CAAP;AAuCA;;AAED,eAAe,MAAf","file":"/packages/jagi:astronomy/lib/modules/fields/utils/raw_one.js.map","sourcesContent":["import _ from 'lodash';\nimport AstroClass from '../../../core/class.js';\nimport traverse from './traverse.js';\nimport rawAll from './raw_all.js';\n\nfunction rawOne(doc, fieldPattern, options) {\n\t// Prepare options.\n\toptions = _.extend({\n\t\ttransient: true,\n\t\timmutable: true\n\t}, options);\n\n\treturn traverse(\n\t\tdoc, fieldPattern,\n\t\tfunction(nestedDoc, nestedFieldName, field) {\n\t\t\t// If a field does not exist than we don't return anything.\n\t\t\tif (!field) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Don't get a transient field.\n\t\t\tif (!options.transient && field.transient) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Don't get an immutable field.\n\t\t\tif (!options.immutable && field.immutable) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get a value to be returned.\n\t\t\tlet fieldValue = nestedDoc[nestedFieldName];\n\n\t\t\tif (fieldValue instanceof AstroClass) {\n\t\t\t\treturn rawAll(fieldValue, options);\n\t\t\t}\n\t\t\telse if (_.isArray(fieldValue)) {\n\t\t\t\treturn _.map(fieldValue, function(element) {\n\t\t\t\t\tif (element instanceof AstroClass) {\n\t\t\t\t\t\treturn rawAll(element, options);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn element;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn fieldValue;\n\t\t\t}\n\t\t}\n\t);\n};\n\nexport default rawOne;"]},"hash":"7d630b612b90fa1e4bde1bf2c5b85c1889582c04"}
