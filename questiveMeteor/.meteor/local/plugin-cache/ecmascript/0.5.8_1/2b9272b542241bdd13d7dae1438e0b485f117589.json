{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"./accounts_common.js","imported":["AccountsCommon"],"specifiers":[{"kind":"named","imported":"AccountsCommon","local":"AccountsCommon"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/accounts-base/accounts_rate_limit.js","filenameRelative":"/packages/accounts-base/accounts_rate_limit.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/accounts-base/accounts_rate_limit.js.map","sourceFileName":"/packages/accounts-base/accounts_rate_limit.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"accounts_rate_limit"},"ignored":false,"code":"var AccountsCommon;module.import(\"./accounts_common.js\",{\"AccountsCommon\":function(v){AccountsCommon=v}});\n\nvar Ap = AccountsCommon.prototype;\nvar defaultRateLimiterRuleId;\n// Removes default rate limiting rule\nAp.removeDefaultRateLimit = function () {\n  var resp = DDPRateLimiter.removeRule(defaultRateLimiterRuleId);\n  defaultRateLimiterRuleId = null;\n  return resp;\n};\n\n// Add a default rule of limiting logins, creating new users and password reset\n// to 5 times every 10 seconds per connection.\nAp.addDefaultRateLimit = function () {\n  if (!defaultRateLimiterRuleId) {\n    defaultRateLimiterRuleId = DDPRateLimiter.addRule({\n      userId: null,\n      clientAddress: null,\n      type: 'method',\n      name: function () {\n        function name(_name) {\n          return _.contains(['login', 'createUser', 'resetPassword', 'forgotPassword'], _name);\n        }\n\n        return name;\n      }(),\n      connectionId: function () {\n        function connectionId(_connectionId) {\n          return true;\n        }\n\n        return connectionId;\n      }()\n    }, 5, 10000);\n  }\n};\n\nAp.addDefaultRateLimit();","ast":null,"map":{"version":3,"sources":["/packages/accounts-base/accounts_rate_limit.js"],"names":[],"mappings":"AAAA,SAAQ,cAAR,QAA6B,sBAA7B;;AAEA,IAAI,KAAK,eAAe,SAAxB;AACA,IAAI,wBAAJ;;AAEA,GAAG,sBAAH,GAA4B,YAAY;AACtC,MAAM,OAAO,eAAe,UAAf,CAA0B,wBAA1B,CAAb;AACA,6BAA2B,IAA3B;AACA,SAAO,IAAP;AACD,CAJD;;;;AAQA,GAAG,mBAAH,GAAyB,YAAY;AACnC,MAAI,CAAC,wBAAL,EAA+B;AAC7B,+BAA2B,eAAe,OAAf,CAAuB;AAChD,cAAQ,IADwC;AAEhD,qBAAe,IAFiC;AAGhD,YAAM,QAH0C;AAIhD;AAAM,sBAAU,KAAV,EAAgB;AACpB,iBAAO,EAAE,QAAF,CAAW,CAAC,OAAD,EAAU,YAAV,EAAwB,eAAxB,EAChB,gBADgB,CAAX,EACc,KADd,CAAP;AAED;;AAHD;AAAA,SAJgD;AAQhD;AAAc,8BAAU,aAAV,EAAwB;AACpC,iBAAO,IAAP;AACD;;AAFD;AAAA;AARgD,KAAvB,EAWxB,CAXwB,EAWrB,KAXqB,CAA3B;AAYD;AACF,CAfD;;AAiBA,GAAG,mBAAH","file":"/packages/accounts-base/accounts_rate_limit.js.map","sourcesContent":["import {AccountsCommon} from \"./accounts_common.js\";\n\nvar Ap = AccountsCommon.prototype;\nvar defaultRateLimiterRuleId;\n// Removes default rate limiting rule\nAp.removeDefaultRateLimit = function () {\n  const resp = DDPRateLimiter.removeRule(defaultRateLimiterRuleId);\n  defaultRateLimiterRuleId = null;\n  return resp;\n};\n\n// Add a default rule of limiting logins, creating new users and password reset\n// to 5 times every 10 seconds per connection.\nAp.addDefaultRateLimit = function () {\n  if (!defaultRateLimiterRuleId) {\n    defaultRateLimiterRuleId = DDPRateLimiter.addRule({\n      userId: null,\n      clientAddress: null,\n      type: 'method',\n      name: function (name) {\n        return _.contains(['login', 'createUser', 'resetPassword',\n          'forgotPassword'], name);\n      },\n      connectionId: function (connectionId) {\n        return true;\n      }\n    }, 5, 10000);\n  }\n};\n\nAp.addDefaultRateLimit();\n"]},"hash":"2b9272b542241bdd13d7dae1438e0b485f117589"}
