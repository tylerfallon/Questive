{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/jagi:astronomy/test/modules/events/cancelable.js","filenameRelative":"/packages/jagi:astronomy/test/modules/events/cancelable.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/jagi:astronomy/test/modules/events/cancelable.js.map","sourceFileName":"/packages/jagi:astronomy/test/modules/events/cancelable.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"cancelable"},"ignored":false,"code":"Tinytest.add('Modules - Events - Cancelable', function (test) {\n  var CancelableNestedEvent = Astro.Class.create({\n    name: 'CancelableNestedEvent',\n    events: {\n      beforeSave: function beforeSave(e) {\n        var doc = e.target;\n        if (doc.preventNested) {\n          e.preventDefault();\n        }\n      }\n    }\n  });\n\n  var CancelableEvents = new Mongo.Collection(null);\n\n  var CancelableEvent = Astro.Class.create({\n    name: 'CancelableEvent',\n    collection: CancelableEvents,\n    fields: {\n      one: {\n        type: CancelableNestedEvent,\n        'default': function _default() {\n          return new CancelableNestedEvent();\n        }\n      },\n      many: {\n        type: [CancelableNestedEvent],\n        'default': function _default() {\n          return [new CancelableNestedEvent()];\n        }\n      },\n      prevent: {\n        type: Boolean,\n        'default': false\n      },\n      preventNested: {\n        type: Boolean,\n        'default': false\n      }\n    },\n    events: {\n      beforeSave: function beforeSave(e) {\n        var doc = e.currentTarget;\n        if (doc.prevent) {\n          e.preventDefault();\n        }\n      }\n    }\n  });\n\n  var event = new CancelableEvent();\n\n  // Prevent nested.\n  event.prevent = false;\n  event.preventNested = true;\n  test.throws(function () {\n    event.save();\n  }, 'Operation prevented [prevented]');\n\n  // Prevent.\n  event.prevent = true;\n  event.preventNested = false;\n  test.throws(function () {\n    event.save();\n  }, 'Operation prevented [prevented]');\n\n  // Do not prevent.\n  event.prevent = false;\n  event.preventNested = false;\n  event.save();\n  test.isNotNull(event._id, 'Execution of the operation should not be prevented');\n});","ast":null,"map":{"version":3,"sources":["/packages/jagi:astronomy/test/modules/events/cancelable.js"],"names":[],"mappings":"AAAA,SAAS,GAAT,CAAa,+BAAb,EAA8C,UAAS,IAAT,EAAe;AAC3D,MAAI,wBAAwB,MAAM,KAAN,CAAY,MAAZ,CAAmB;AAC7C,UAAM,uBADuC;AAE7C,YAAQ;AACN,kBAAY,oBAAS,CAAT,EAAY;AACtB,YAAI,MAAM,EAAE,MAAZ;AACA,YAAI,IAAI,aAAR,EAAuB;AACrB,YAAE,cAAF;AACD;AACF;AANK;AAFqC,GAAnB,CAA5B;;AAYA,MAAI,mBAAmB,IAAI,MAAM,UAAV,CAAqB,IAArB,CAAvB;;AAEA,MAAI,kBAAkB,MAAM,KAAN,CAAY,MAAZ,CAAmB;AACvC,UAAM,iBADiC;AAEvC,gBAAY,gBAF2B;AAGvC,YAAQ;AACN,WAAK;AACH,cAAM,qBADH;AAEH,mBAAS,oBAAW;AAClB,iBAAO,IAAI,qBAAJ,EAAP;AACD;AAJE,OADC;AAON,YAAM;AACJ,cAAM,CAAC,qBAAD,CADF;AAEJ,mBAAS,oBAAW;AAClB,iBAAO,CAAC,IAAI,qBAAJ,EAAD,CAAP;AACD;AAJG,OAPA;AAaN,eAAS;AACP,cAAM,OADC;AAEP,mBAAS;AAFF,OAbH;AAiBN,qBAAe;AACb,cAAM,OADO;AAEb,mBAAS;AAFI;AAjBT,KAH+B;AAyBvC,YAAQ;AACN,kBAAY,oBAAS,CAAT,EAAY;AACtB,YAAI,MAAM,EAAE,aAAZ;AACA,YAAI,IAAI,OAAR,EAAiB;AACf,YAAE,cAAF;AACD;AACF;AANK;AAzB+B,GAAnB,CAAtB;;AAmCA,MAAI,QAAQ,IAAI,eAAJ,EAAZ;;;AAGA,QAAM,OAAN,GAAgB,KAAhB;AACA,QAAM,aAAN,GAAsB,IAAtB;AACA,OAAK,MAAL,CACE,YAAW;AACT,UAAM,IAAN;AACD,GAHH,EAIE,iCAJF;;;AAQA,QAAM,OAAN,GAAgB,IAAhB;AACA,QAAM,aAAN,GAAsB,KAAtB;AACA,OAAK,MAAL,CACE,YAAW;AACT,UAAM,IAAN;AACD,GAHH,EAIE,iCAJF;;;AAQA,QAAM,OAAN,GAAgB,KAAhB;AACA,QAAM,aAAN,GAAsB,KAAtB;AACA,QAAM,IAAN;AACA,OAAK,SAAL,CAAe,MAAM,GAArB,EACE,oDADF;AAGD,CA/ED","file":"/packages/jagi:astronomy/test/modules/events/cancelable.js.map","sourcesContent":["Tinytest.add('Modules - Events - Cancelable', function(test) {\n  let CancelableNestedEvent = Astro.Class.create({\n    name: 'CancelableNestedEvent',\n    events: {\n      beforeSave: function(e) {\n        var doc = e.target;\n        if (doc.preventNested) {\n          e.preventDefault();\n        }\n      }\n    }\n  });\n\n  let CancelableEvents = new Mongo.Collection(null);\n\n  let CancelableEvent = Astro.Class.create({\n    name: 'CancelableEvent',\n    collection: CancelableEvents,\n    fields: {\n      one: {\n        type: CancelableNestedEvent,\n        default: function() {\n          return new CancelableNestedEvent();\n        }\n      },\n      many: {\n        type: [CancelableNestedEvent],\n        default: function() {\n          return [new CancelableNestedEvent()];\n        }\n      },\n      prevent: {\n        type: Boolean,\n        default: false\n      },\n      preventNested: {\n        type: Boolean,\n        default: false\n      }\n    },\n    events: {\n      beforeSave: function(e) {\n        var doc = e.currentTarget;\n        if (doc.prevent) {\n          e.preventDefault();\n        }\n      }\n    }\n  });\n\n  let event = new CancelableEvent();\n\n  // Prevent nested.\n  event.prevent = false;\n  event.preventNested = true;\n  test.throws(\n    function() {\n      event.save();\n    },\n    'Operation prevented [prevented]'\n  );\n\n  // Prevent.\n  event.prevent = true;\n  event.preventNested = false;\n  test.throws(\n    function() {\n      event.save();\n    },\n    'Operation prevented [prevented]'\n  );\n\n  // Do not prevent.\n  event.prevent = false;\n  event.preventNested = false;\n  event.save();\n  test.isNotNull(event._id,\n    'Execution of the operation should not be prevented'\n  );\n});\n"]},"hash":"d4d52f053f19c2d46d200ae7d385ff33db1cdf76"}
