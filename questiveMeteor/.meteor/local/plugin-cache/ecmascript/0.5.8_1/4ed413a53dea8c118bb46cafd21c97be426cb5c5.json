{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"semver","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"semver"}]},{"source":"meteor/underscore","imported":["_"],"specifiers":[{"kind":"named","imported":"_","local":"_"}]}],"exports":{"exported":["checkNpmVersions"],"specifiers":[{"kind":"local","local":"checkNpmVersions","exported":"checkNpmVersions"}]}}},"options":{"filename":"/packages/tmeasday:check-npm-versions/check-npm-versions.js","filenameRelative":"/packages/tmeasday:check-npm-versions/check-npm-versions.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/tmeasday:check-npm-versions/check-npm-versions.js.map","sourceFileName":"/packages/tmeasday:check-npm-versions/check-npm-versions.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"check-npm-versions"},"ignored":false,"code":"module.export({checkNpmVersions:function(){return checkNpmVersions}});var semver;module.import('semver',{\"default\":function(v){semver=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});\n\n\n// Returns:\n//   - true      if a version of the package in the range is installed\n//   - false     if no version is installed\n//   - version#  if incompatible version is installed\nvar compatibleVersionIsInstalled = function compatibleVersionIsInstalled(name, range) {\n  try {\n    var installedVersion = require(name + '/package.json').version;\n    if (semver.satisfies(installedVersion, range)) {\n      return true;\n    } else {\n      return installedVersion;\n    }\n  } catch (e) {\n    console.log(e);\n    // XXX I guess the only error here is that the module doesn't exist?\n    return false;\n  }\n};\n\nvar checkNpmVersions = function checkNpmVersions(packages, packageName) {\n  var failures = {};\n  _.forEach(packages, function (range, name) {\n    var failure = compatibleVersionIsInstalled(name, range);\n    if (failure !== true) {\n      failures[name] = failure;\n    }\n  });\n\n  if (_.keys(failures).length === 0) {\n    return true;\n  }\n\n  var errors = [];\n  _.forEach(failures, function (installed, name) {\n    var requirement = name + '@' + packages[name];\n\n    if (installed) {\n      errors.push(' - ' + name + '@' + installed + ' installed, ' + requirement + ' needed');\n    } else {\n      errors.push(' - ' + name + '@' + packages[name] + ' not installed.');\n    }\n  });\n\n  var qualifier = packageName ? '(for ' + packageName + ') ' : '';\n  console.warn('WARNING: npm peer requirements ' + qualifier + 'not installed:\\n' + errors.join('\\n') + '\\n\\nRead more about installing npm peer dependencies:\\n  http://guide.meteor.com/using-packages.html#peer-npm-dependencies\\n');\n};","ast":null,"map":{"version":3,"sources":["/packages/tmeasday:check-npm-versions/check-npm-versions.js"],"names":[],"mappings":"AAAA,OAAO,MAAP,MAAmB,QAAnB;AACA,SAAS,CAAT,QAAkB,mBAAlB;;;;;;AAMA,IAAM,+BAA+B,SAA/B,4BAA+B,CAAC,IAAD,EAAO,KAAP,EAAiB;AACpD,MAAI;AACF,QAAM,mBAAmB,QAAW,IAAX,oBAAgC,OAAzD;AACA,QAAI,OAAO,SAAP,CAAiB,gBAAjB,EAAmC,KAAnC,CAAJ,EAA+C;AAC7C,aAAO,IAAP;AACD,KAFD,MAEO;AACL,aAAO,gBAAP;AACD;AACF,GAPD,CAOE,OAAO,CAAP,EAAU;AACV,YAAQ,GAAR,CAAY,CAAZ;;AAEA,WAAO,KAAP;AACD;AACF,CAbD;;AAeA,OAAO,IAAM,mBAAmB,SAAnB,gBAAmB,CAAC,QAAD,EAAW,WAAX,EAA2B;AACzD,MAAM,WAAW,EAAjB;AACA,IAAE,OAAF,CAAU,QAAV,EAAoB,UAAC,KAAD,EAAQ,IAAR,EAAiB;AACnC,QAAM,UAAU,6BAA6B,IAA7B,EAAmC,KAAnC,CAAhB;AACA,QAAI,YAAY,IAAhB,EAAsB;AACpB,eAAS,IAAT,IAAiB,OAAjB;AACD;AACF,GALD;;AAOA,MAAI,EAAE,IAAF,CAAO,QAAP,EAAiB,MAAjB,KAA4B,CAAhC,EAAmC;AACjC,WAAO,IAAP;AACD;;AAED,MAAM,SAAS,EAAf;AACA,IAAE,OAAF,CAAU,QAAV,EAAoB,UAAC,SAAD,EAAY,IAAZ,EAAqB;AACvC,QAAM,cAAiB,IAAjB,SAAyB,SAAS,IAAT,CAA/B;;AAEA,QAAI,SAAJ,EAAe;AACb,aAAO,IAAP,SAAkB,IAAlB,SAA0B,SAA1B,oBAAkD,WAAlD;AACD,KAFD,MAEO;AACL,aAAO,IAAP,SAAkB,IAAlB,SAA0B,SAAS,IAAT,CAA1B;AACD;AACF,GARD;;AAUA,MAAM,YAAY,wBAAsB,WAAtB,UAAwC,EAA1D;AACA,UAAQ,IAAR,qCAA+C,SAA/C,wBACA,OAAO,IAAP,CAAY,IAAZ,CADA;AAMD,CA/BM","file":"/packages/tmeasday:check-npm-versions/check-npm-versions.js.map","sourcesContent":["import semver from 'semver';\nimport { _ } from 'meteor/underscore';\n\n// Returns:\n//   - true      if a version of the package in the range is installed\n//   - false     if no version is installed\n//   - version#  if incompatible version is installed\nconst compatibleVersionIsInstalled = (name, range) => {\n  try {\n    const installedVersion = require(`${name}/package.json`).version;  \n    if (semver.satisfies(installedVersion, range)) {\n      return true;\n    } else {\n      return installedVersion;\n    }\n  } catch (e) {\n    console.log(e)\n    // XXX I guess the only error here is that the module doesn't exist?\n    return false;\n  }\n};\n\nexport const checkNpmVersions = (packages, packageName) => {\n  const failures = {};\n  _.forEach(packages, (range, name) => {\n    const failure = compatibleVersionIsInstalled(name, range);\n    if (failure !== true) {\n      failures[name] = failure;\n    }\n  });\n\n  if (_.keys(failures).length === 0) {\n    return true;\n  }\n\n  const errors = [];\n  _.forEach(failures, (installed, name) => {\n    const requirement = `${name}@${packages[name]}`;\n\n    if (installed) {\n      errors.push(` - ${name}@${installed} installed, ${requirement} needed`);\n    } else {\n      errors.push(` - ${name}@${packages[name]} not installed.`);\n    }\n  });\n\n  const qualifier = packageName ? `(for ${packageName}) ` : '';\n  console.warn(`WARNING: npm peer requirements ${qualifier}not installed:\n${errors.join('\\n')}\n\nRead more about installing npm peer dependencies:\n  http://guide.meteor.com/using-packages.html#peer-npm-dependencies\n`);\n};\n"]},"hash":"4ed413a53dea8c118bb46cafd21c97be426cb5c5"}
